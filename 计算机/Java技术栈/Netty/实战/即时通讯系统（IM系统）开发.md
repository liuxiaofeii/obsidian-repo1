---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'


# Excalidraw Data
## Text Elements
前期：调研、选型、测试、联调 ^TjpDSGa1

整体架构图 ^eMbUhbHZ

一个基本的IM系统的构成 ^x5jQeqt7

用户是消息的发起者 ^20AdGqfw

关系链是指用户与用户之间的关联。
例如，OA系统里用户与用户之间可能是上下级；
电商系统里面用户与用户之间可能是买家和卖家；
在IM系统里面用户与用户之间是好友或者非好友关系、拉黑或者非拉黑关系。 ^DfVm64SH

会话是用户与用户之间产生消息的产物，
在QQ和微信里面也是通过消息而产生会话 ^XP1SbPe2

客户 ^LE1PmDde

客服 ^ypldcG9e

客服端发起长轮询向服务器尝试获取新消息，
如果没有消息则会定时反复执行这个操作 ^jeAt3G0n

缺点：存在很多的空循环：如果客服与用户之间没有产生消息，整个系统也是在不断的轮询获取空数据 ^A0eab56U

## Embedded Files
2d419ee97e0d446b45b091956294fa0621dac84f: [[Pasted Image 20240529101108_153.png]]
43775388aaef3b91889b7560ab30ecc0fa90fd21: [[Pasted Image 20240529101748_061.png]]
20377c1912254768a3f56b0241ac9fb3c5d02463: [[Pasted Image 20240529102444_002.png]]
35643e0c3c29122e3235be3be94b9820b643136b: [[Pasted Image 20240529103206_071.png]]
cf4054495a7861d6eb811d5dac821eda4c29368f: [[Pasted Image 20240529104228_197.png]]

%%
## Drawing
```compressed-json
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
```
%%